[ src ]

url = https://www.musl-libc.org/releases/musl-<ver>.tar.gz
src_type = tar
src_dirname = <prog>-<ver>



[ vars ]



[ musl ]

env =
prepare = tar --no-same-owner -xf <src_path> -C <tmp_dir>
configure = ./configure
	--prefix=
	--disable-shared

build = make
pkg_create = make DESTDIR=<pkg_dir> install



[ musl_1_cross ]

env =
prepare = tar --no-same-owner -xf <src_path> -C <tmp_dir>
configure = ./configure CROSS_COMPILE=${TARGET_TRIPLET}- --prefix=
build = make
pkg_create = make DESTDIR=<pkg_dir>/cross_tools install &&
	mkdir -pv <pkg_dir>/cross_tools/{etc,bin,lib,usr} &&
	ln -sv ../include  <pkg_dir>/cross_tools/usr/include &&
	ln -svf libc.so <pkg_dir>/cross_tools/lib/ld-musl-x86_64.so.1 &&
	ln -sv ../lib/ld-musl-x86_64.so.1 <pkg_dir>/cross_tools/bin/ldd &&
	printf '%s\n%s\n' <pkg_dir>/cross_tools/lib <pkg_dir>/tools/lib >>
		<pkg_dir>/cross_tools/etc/ld-musl-x86_64.path



[ musl_2_cross ]

env =
prepare = tar --no-same-owner -xf <src_path> -C <tmp_dir>
configure = ./configure CROSS_COMPILE=${TARGET_TRIPLET}- --prefix=
build = make
pkg_create = make DESTDIR=<pkg_dir>/tools install &&
	ln -svf libc.so <pkg_dir>/tools/lib/ld-musl-x86_64.so.1 &&
	mkdir -v <pkg_dir>/tools/etc &&
	printf '%s\n%s\n' /tools/lib <pkg_dir>/tools/lib >>
		<pkg_dir>/tools/etc/ld-musl-x86_64.path

